<!DOCTYPE html>
<html lang="en-us">
  
  <head>
  <meta charset="UTF-8">
  <title></title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
  <link rel="stylesheet" href="/css/yvandchanges.css">
</head>

  <body>
    <section class="page-header">
  <h1 class="project-name">AzureCP</h1>
  <h2 class="project-tagline">Azure Active Directory claims provider for SharePoint</h2>
  <a href="https://github.com/Yvand/AzureCP" target="_blank" class="btn">View project on GitHub</a>
  <a href="https://github.com/Yvand/AzureCP/releases/download/v2016.12/AzureCP.wsp" class="btn">Download AzureCP</a>
</section>


    <section style="">
      <!--<div style="display: block;">-->
        <div class="navigation">
            <h2><a href="index.html">AzureCP</a></h2>
<ul>

    <li><a href="Install-AzureCP.html" alt="Install">Install</a></li>

    <li><a href="Update-AzureCP.html" alt="Update">Update</a></li>

    <li><a href="Remove-AzureCP.html" alt="Remove">Remove</a></li>

    <li><a href="Configure-AzureCP.html" alt="Configure">Configure</a></li>

</ul>
        </div>
        <div class="main-content">
            <h2 id="how-to-install-azurecp">How to install AzureCP</h2>
<p>Download <a href="https://github.com/Yvand/AzureCP/releases/latest">latest release</a>.
Install and deploy the solution (that will automatically activate the “AzureCP” farm feature):</p>
<div class="language-powershell highlighter-rouge"><pre class="highlight"><code>Add-SPSolution <span class="s2">"PATH TO WSP FILE"</span>
Install-SPSolution -Identity <span class="s2">"AzureCP.wsp"</span> -GACDeployment
</code></pre>
</div>

<p>At this point AzureCP is inactive and it must be associated to a SPTrustedIdentityTokenIssuer:</p>
<div class="language-powershell highlighter-rouge"><pre class="highlight"><code><span class="nv">$trust</span> <span class="o">=</span> Get-SPTrustedIdentityTokenIssuer <span class="s2">"SPTRUST NAME"</span>
<span class="nv">$trust</span>.ClaimProviderName <span class="o">=</span> <span class="s2">"AzureCP"</span>
<span class="nv">$trust</span>.Update<span class="o">()</span>
</code></pre>
</div>

<p>Finally, AzureCP must be registered as an application in Azure Active Directory to be able to query it, with permission “Read directory data”.<br />
<a href="https://github.com/AzureADSamples/ConsoleApp-GraphAPI-DotNet">This article</a> explains how to register the app (start from Step 3).</p>

<p>Once the app is created in Azure AD, information can be entered in Central Administration &gt; Security &gt; AzureCP Glogal configuration &gt; “New Azure tenant” section.</p>

<h2 id="important---limitations">Important - Limitations</h2>
<p>Due to limitations of SharePoint API, do not associate AzureCP with more than 1 SPTrustedIdentityTokenIssuer.</p>

<p>You must manually deploy AzureCP.dll on SharePoint servers that do not have SharePoint service “Microsoft SharePoint Foundation Web Application” started. You can use this PowerShell script:</p>
<div class="language-powershell highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>System.Reflection.Assembly]::Load<span class="o">(</span><span class="s2">"System.EnterpriseServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"</span><span class="o">)</span>
<span class="nv">$publish</span> <span class="o">=</span> <span class="nb">New-Object </span>System.EnterpriseServices.Internal.Publish
<span class="nv">$publish</span>.GacInstall<span class="o">(</span><span class="s2">"C:</span><span class="se">\D</span><span class="s2">ata</span><span class="se">\D</span><span class="s2">ev</span><span class="se">\A</span><span class="s2">zureCP.dll"</span><span class="o">)</span>
</code></pre>
</div>

        </div>
      <!--</div>-->
    </section>
    <footer class="site-footer">
  <span class="site-footer-owner"><a href="index.html">AzureCP</a> is maintained by <a href="https://www.linkedin.com/in/yvand/" target="_blank">Yvan Duhamel</a>.</span>
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
</footer>

  </body>
</html>
